# Kong Gateway 配置文件
# Kong APIM Platform - Gateway Configuration

# 資料庫配置 (PostgreSQL)
database = postgres
pg_host = kong-database-master
pg_port = 5432
pg_user = kong
pg_password = kong
pg_database = kong

# 代理設定
proxy_listen = 0.0.0.0:8000
proxy_listen_ssl = 0.0.0.0:8443

# Admin API 設定
admin_listen = 0.0.0.0:8001
admin_listen_ssl = 0.0.0.0:8444

# 日誌設定
proxy_access_log = /dev/stdout
admin_access_log = /dev/stdout
proxy_error_log = /dev/stderr
admin_error_log = /dev/stderr
log_level = info

# 性能設定
worker_processes = auto
worker_connections = 1024

# 插件設定
plugins = bundled,http-log

# 安全性設定
real_ip_header = X-Real-IP
real_ip_recursive = on
trusted_ips = 0.0.0.0/0,::/0

# Nginx 設定
nginx_worker_processes = auto
nginx_daemon = off

# 前綴設定
prefix = /usr/local/kong

# SSL 設定
ssl_cert_key = /usr/local/kong/ssl/kong-default.key
ssl_cert = /usr/local/kong/ssl/kong-default.crt

# 客戶端設定
client_max_body_size = 0
client_body_buffer_size = 8k

# 上游設定
upstream_keepalive_pool_size = 60
upstream_keepalive_max_requests = 100
upstream_keepalive_idle_timeout = 60s